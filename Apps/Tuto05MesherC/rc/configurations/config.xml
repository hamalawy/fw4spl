<plugin id="MesherV3Config">
	
    <extension id="MesherV3Config" implements="::fwData::Composite">
  
    <!--  Composite data creation. -->
    <object id="Img_And_Mesh" type="::fwData::Composite">
  
        <!-- Service associated to the Composite data :
        main window creation. -->
        <service type="::gui::aspect::IAspect" implementation="::gui::aspect::DefaultAspect" autoComChannel="no" >
            <name>MyApp</name>
            <minSize width="720" height="600"/>
            <views>
                <view guiContainerId="900"/>
                <view guiContainerId="901" minWidth="500" minHeight="100"/>
                <view guiContainerId="902" minWidth="500" minHeight="100"/>
                <view guiContainerId="903" minWidth="500" minHeight="100"/>
            </views>
            <menus>
                <menu uid="menuFile"/>
                <menu uid="menuMesher"/>
		<menu uid="menuEdit"/>
            </menus>
        </service>


        <!-- Service associated to the Composite data :
        menu creation. -->
        <service name="File" uid="menuFile" type="::gui::aspect::IMenu" implementation="::gui::aspect::DefaultMenu" autoComChannel="no" >
            <action uid="actionOpenImageFile"/>
            <action uid="actionSaveImageFile"/>
            <separator/>
			<action uid="actionQuit"/>
        </service>           

        <service name="Mesher" uid="menuMesher" type="::gui::aspect::IMenu" implementation="::gui::aspect::DefaultMenu" autoComChannel="no" >
            <action uid="actionCreateVTKMesh1"/>
            <action uid="actionCreateVTKMesh2"/>
        </service> 
    
        <service uid="actionQuit" specialAction="QUIT"  name="Quit" type="::gui::action::IAction" implementation="::gui::action::QuitAction" shortcut="Ctrl+Q" autoComChannel="no" />
		
		<!-- Added for material changing for the meshes -->
		<service name="Edit" uid="menuEdit" type="::gui::action::IAction" implementation="gui::action::DefaultMenu" autoCommChannel="no">
			<action uid="actionChangeMat"/>
		</service>

        <!-- Service associated to the Composite data :
        menu services creation.
        Actions in relationship with images and meshes-->
        <service uid="actionOpenImageFile" type="::gui::action::IAction" implementation="::gui::action::StarterActionService" name="Open image file" autoComChannel="no" >
            <start uid="readerPathImageFile"/>
        </service>

        <service uid="actionSaveImageFile" type="::gui::action::IAction" implementation="::gui::action::StarterActionService" name="Save image file" autoComChannel="no" >
            <start uid="writerImageFile"/>
        </service> 
    
        <service uid="actionOpenMeshFile" type="::gui::action::IAction" implementation="::gui::action::StarterActionService" name="Open mesh file" autoComChannel="no" >
            <start uid="readerPathMeshFile"/>
        </service>
    
        <service uid="actionSaveMeshFile" type="::gui::action::IAction" implementation="::gui::action::StarterActionService" name="Save mesh file" autoComChannel="no" >
            <start uid="writerMeshFile"/>
        </service>    
    
        <service uid="actionCreateVTKMesh1" type="::gui::action::IAction" implementation="::opVTKMesh::action::VTKMeshCreation" name="Compute Mesh1 (VTK)" autoComChannel="no" >
            <image uid="myImage"/>
            <mesh uid="myMesh1"/>
			<percentReduction value="50"/>
        </service>

        <service uid="actionCreateVTKMesh2" type="::gui::action::IAction" implementation="::opVTKMesh::action::VTKMeshCreation" name="Compute Mesh2 (VTK)" autoComChannel="no" >
            <image uid="myImage"/>
            <mesh uid="myMesh2"/>
			<percentReduction value="80"/>
        </service>

        <service implementation="::vtkCompositeMesh::RendererService" type="::fwRender::IRender" uid="RenderingMesh" autoComChannel="yes" >
            <win guiContainerId="903"/>
        </service>
		
		<!-- Added for action material changing for the meshes -->
		<service uid="actionChangeMat" type="::gui::action::IAction" implementation="::vtkCompositeMesh::ChangeMaterialService" autoCommChannel="no" />

                          

        <!-- Image object creation 
        Services contained between the tags <object> and </object>
        are associated to the Image data. -->
        <object id="myImage" uid="myImage" type="::fwData::Image">

            <!-- Services associated to the Image data :
            Visualization, reading and writing service creation. -->
            <service implementation="::vtkSimpleNegato::RendererService" type="::fwRender::IRender" uid="RenderingImage" autoComChannel="yes" >
                <win guiContainerId="900"/>
            </service>

            <service implementation="::uiIO::editor::IOSelectorService" type="::gui::editor::IEditor" uid="readerPathImageFile" autoComChannel="no" >
                <type mode="reader"/>
            </service>


            <service implementation="::uiIO::editor::IOSelectorService" type="::gui::editor::IEditor" uid="writerImageFile" autoComChannel="no" >
                <type mode="writer"/>
            </service>

        </object>       

        <!-- TriangularMesh objet creation1. 
        Services contained between the tags <object> and </object> 
        are associated to the TriangularMesh data. -->
        <object id="myMesh1" uid="myMesh1" type="::fwData::TriangularMesh">
		
			<service implementation="::vtkSimpleMesh::RendererService" type="::fwRender::IRender" uid="RenderingMesh1" autoComChannel="yes" >
				<win guiContainerId="901"/>
			</service>

            <service uid="MyComChannelSrv1" implementation="::fwServices::ComChannelService" type="::fwServices::ICommunication" autoComChannel="no" >
				<target>RenderingMesh</target>	
			</service>
			
        </object> 

        <!-- TriangularMesh objet creation2. 
        Services contained between the tags <object> and </object> 
        are associated to the TriangularMesh data. -->
        <object id="myMesh2" uid="myMesh2" type="::fwData::TriangularMesh">

			<service implementation="::vtkSimpleMesh::RendererService" type="::fwRender::IRender" uid="RenderingMesh2" autoComChannel="yes" >
				<win guiContainerId="902"/>
			</service>
			
			<service uid="MyComChannelSrv2" implementation="::fwServices::ComChannelService" type="::fwServices::ICommunication" autoComChannel="no" >
				<target>RenderingMesh</target>				
        	</service>
			
        </object> 
    
    <!-- In order to start the different services,
    it does not need to follow the objects creation order.
    Note that the services associated to the Image and TriangularMesh data
    are not started between the tags corresponding to these two data definitions
    but, before the end of the Composite data definition. -->
    <start type="::gui::aspect::IAspect" />
    <start uid="RenderingImage" />
    <start uid="RenderingMesh" />
    <start uid="RenderingMesh1" />
    <start uid="RenderingMesh2" />
	<start uid="actionChangeMat"/>
	<start uid="MyComChannelSrv1" />
    <start uid="MyComChannelSrv2" />


	
    <stop uid="MyComChannelSrv2" />	
    <stop uid="MyComChannelSrv1" />
	<stop uid="actionChangeMat"/>
    <stop uid="RenderingImage" />
    <stop uid="RenderingMesh" />
    <stop uid="RenderingMesh1" />
    <stop uid="RenderingMesh2" />

    <stop type="::gui::aspect::IAspect" />
  </object>
  </extension>
</plugin>    
